import asyncio
import csv
import os
from playwright.async_api import async_playwright

LIST = ['https://www.facebook.com/eternalhightechofficial/', 'https://www.facebook.com/evangelistfranklinjoshua/', 'https://www.facebook.com/ewithsDM/', 'https://www.facebook.com/famezopmedia/', 'https://www.facebook.com/filtercoffeeadvertising/', 'https://www.facebook.com/fiveelementmeditation/', 'https://www.facebook.com/flexisigntangla/', 'https://www.facebook.com/fsopa.kolkata/', 'https://www.facebook.com/futuredreamuae/', 'https://www.facebook.com/futureschoolin/', 'https://www.facebook.com/ganhsaspanditji/', 'https://www.facebook.com/gcsconsultingservices/', 'https://www.facebook.com/gillsmartjobs/', 'https://www.facebook.com/goodadsmatter/', 'https://www.facebook.com/goodtreeagency/', 'https://www.facebook.com/grandcafeadvertising/', 'https://www.facebook.com/greatdigitalacademy/', 'https://www.facebook.com/greenparrottalkies/', 'https://www.facebook.com/groupg.co.in/', 'https://www.facebook.com/groups/1190266305757694', 'https://www.facebook.com/groups/gulfjobsinterviews/', 'https://www.facebook.com/gulfjobsfortamilans/', 'https://www.facebook.com/harathiin/', 'https://www.facebook.com/help/396404120401278/list', 'https://www.facebook.com/hitektrainings/', 'https://www.facebook.com/homeforentertaining/', 'https://www.facebook.com/houstonkold/', 'https://www.facebook.com/impurvi.jayaaraaj/', 'https://www.facebook.com/ind.builderlobby/', 'https://www.facebook.com/indeedseo/', 'https://www.facebook.com/innerpowerhealingtemple/', 'https://www.facebook.com/innoventexsolutions/', 'https://www.facebook.com/insurmonthly/', 'https://www.facebook.com/isdsialkot/', 'https://www.facebook.com/jamshedpurwomenpower/', 'https://www.facebook.com/jitglobal.in/', 'https://www.facebook.com/jtecheducationtraining/', 'https://www.facebook.com/kaigaltnjobs/', 'https://www.facebook.com/kashidarshanapackage/', 'https://www.facebook.com/kaushikmahapatra.official/', 'https://www.facebook.com/kavyasreedigitalsolutions/', 'https://www.facebook.com/keralatour.information/', 'https://www.facebook.com/ketugrah/', 'https://www.facebook.com/kinkyknotscafe/', 'https://www.facebook.com/kpacmarketing/', 'https://www.facebook.com/kreditbazarofficial/', 'https://www.facebook.com/kvinfotech2/', 'https://www.facebook.com/learnwithdayal/', 'https://www.facebook.com/legendaryfashion1/', 'https://www.facebook.com/letsexplainbusiness/', 'https://www.facebook.com/lkgroupofeducation/', 'https://www.facebook.com/logoclub99/', 'https://www.facebook.com/logtechinfoway1/', 'https://www.facebook.com/loveguruanuragshastri/', 'https://www.facebook.com/loveunitymovementglobal/', 'https://www.facebook.com/lovewithastrology/', 'https://www.facebook.com/maacguwahatilachitnagar/', 'https://www.facebook.com/macwinstudios/', 'https://www.facebook.com/mahatmajitechnical/', 'https://www.facebook.com/mangomarketers/', 'https://www.facebook.com/mangopeelsolutions/', 'https://www.facebook.com/mariyahomecare/', 'https://www.facebook.com/marketingmusketeerofficial/', 'https://www.facebook.com/marwarprint/', 'https://www.facebook.com/mata.heri.31/', 'https://www.facebook.com/mediagarh/', 'https://www.facebook.com/memoirs.blog/', 'https://www.facebook.com/mobidigittechnologies/', 'https://www.facebook.com/monthlybranding/', 'https://www.facebook.com/mrmttibangalore', 'https://www.facebook.com/mrmttibangalore/', 'https://www.facebook.com/mumbaifashionacademy/', 'https://www.facebook.com/newgulfjob/', 'https://www.facebook.com/nexis.school/', 'https://www.facebook.com/nexusspacesindia/', 'https://www.facebook.com/nita-overseas-travel-agency-101206159563175/', 'https://www.facebook.com/nithinshomeoclinic/', 'https://www.facebook.com/nithratelugujobs/', 'https://www.facebook.com/nrtinc/', 'https://www.facebook.com/officialtempledekho/', 'https://www.facebook.com/packagetour.vn/', 'https://www.facebook.com/padmaresortubud/', 'https://www.facebook.com/pharmeasy/', 'https://www.facebook.com/phdguidance/', 'https://www.facebook.com/pixlshark/', 'https://www.facebook.com/pkbalajiagency/', 'https://www.facebook.com/plaiapp/', 'https://www.facebook.com/powerlinkgorakhnath/', 'https://www.facebook.com/priyankapandayofficial/', 'https://www.facebook.com/progzi/', 'https://www.facebook.com/publicitypoint.in/', 'https://www.facebook.com/quadcubes/', 'https://www.facebook.com/qualityeducation2013/', 'https://www.facebook.com/quikygo/', 'https://www.facebook.com/rajdeep.sen.71/', 'https://www.facebook.com/rdvnagpur/', 'https://www.facebook.com/regexsoftwares/', 'https://www.facebook.com/reimagebydiksha/', 'https://www.facebook.com/renbdigital/', 'https://www.facebook.com/renewcoder/', 'https://www.facebook.com/renprintsindia/', 'https://www.facebook.com/revampstudios.in/', 'https://www.facebook.com/roamingtamizha/', 'https://www.facebook.com/rudranshtravels/', 'https://www.facebook.com/rvdigitalmarketingagency/', 'https://www.facebook.com/safalvidyalaya/', 'https://www.facebook.com/sakshinarendra21/', 'https://www.facebook.com/salezrobot/', 'https://www.facebook.com/screenworkinstitute/', 'https://www.facebook.com/seviousdigital/', 'https://www.facebook.com/shamanicyogabylilithmoon/', 'https://www.facebook.com/shantijuniorsofficial/', 'https://www.facebook.com/share/1FrJ2t6RPN/', 'https://www.facebook.com/share/1LnfuHR2CR/', 'https://www.facebook.com/shreedebacharya/', 'https://www.facebook.com/shreeheightschandannagar/', 'https://www.facebook.com/sirigiri.sirigiri.10/', 'https://www.facebook.com/smartmebles/', 'https://www.facebook.com/snapupdesign12/', 'https://www.facebook.com/somratriifb/', 'https://www.facebook.com/soulorganicfarmer/', 'https://www.facebook.com/spooky2rife/', 'https://www.facebook.com/srimurugantravelagency/', 'https://www.facebook.com/stpaulsnursescoachingcentre/', 'https://www.facebook.com/svarmedia/', 'https://www.facebook.com/svetdel/', 'https://www.facebook.com/swayourway/', 'https://www.facebook.com/talentcornerhr/', 'https://www.facebook.com/tantriksriguru/', 'https://www.facebook.com/tarrotwithnj/', 'https://www.facebook.com/taxila.in/', 'https://www.facebook.com/teamdigitalpendu/', 'https://www.facebook.com/teamyog/', 'https://www.facebook.com/techgeminiofficial/', 'https://www.facebook.com/techieglidedigitallearning/', 'https://www.facebook.com/technoglobe.jpr/', 'https://www.facebook.com/techvision.digital/', 'https://www.facebook.com/tgcin/', 'https://www.facebook.com/thamiltemples/', 'https://www.facebook.com/thatcreativestudio2022/', 'https://www.facebook.com/theHouseofmax/', 'https://www.facebook.com/theartoflivingdelhincr/', 'https://www.facebook.com/thecontentstore.in/', 'https://www.facebook.com/themarketingpro/', 'https://www.facebook.com/themexriver/', 'https://www.facebook.com/theneeridaivelai/', 'https://www.facebook.com/thenehalvira/', 'https://www.facebook.com/therightastrologer/', 'https://www.facebook.com/thesmartshoppeeindia/', 'https://www.facebook.com/thetravelschool1/', 'https://www.facebook.com/thinktreemediahouse/', 'https://www.facebook.com/tkhealthtips/', 'https://www.facebook.com/travel-agency-433250533202425/', 'https://www.facebook.com/traveldabbleofficial/', 'https://www.facebook.com/traventmug/', 'https://www.facebook.com/unfoldmart/', 'https://www.facebook.com/upradiocity/', 'https://www.facebook.com/upyoga.in/', 'https://www.facebook.com/urveedesignsindia/', 'https://www.facebook.com/utsav.app.pujas/', 'https://www.facebook.com/uttarakhandexperts/', 'https://www.facebook.com/uzeb-Qureshi-Zain-103825249285171/', 'https://www.facebook.com/vaishnava.astrology.center/', 'https://www.facebook.com/valoonbranding/', 'https://www.facebook.com/valueadsenterprise/', 'https://www.facebook.com/vandanamindmiracle/', 'https://www.facebook.com/vastu.route/', 'https://www.facebook.com/venbapetals/', 'https://www.facebook.com/venxads/', 'https://www.facebook.com/vinayakacampingandadventurezone/', 'https://www.facebook.com/vishalmanocha123/', 'https://www.facebook.com/vishnu00018/', 'https://www.facebook.com/visionparamedicalinsti/', 'https://www.facebook.com/vsgagencyru/', 'https://www.facebook.com/wakenbakeagency/', 'https://www.facebook.com/wakenbakestudio/', 'https://www.facebook.com/warriorsclub.in/', 'https://www.facebook.com/waterindia.in/', 'https://www.facebook.com/weados/', 'https://www.facebook.com/weamplify.club/', 'https://www.facebook.com/weddingdancegurudelhi/', 'https://www.facebook.com/wegiveuability/', 'https://www.facebook.com/wethinknorth/', 'https://www.facebook.com/whiteboardauthors/', 'https://www.facebook.com/wishgeekstechserve/', 'https://www.facebook.com/wonderwaytravelazerbaijan/', 'https://www.facebook.com/yrdesignandconstruction/', 'https://www.facebook.com/zeomedservices/', 'https://facebook.com/100066409195176', 'https://facebook.com/61574675909010', 'https://facebook.com/61574976332970', 'https://facebook.com/Bmsmoney', 'https://facebook.com/CyclonePoultry', 'https://facebook.com/agri.nkosh', 'https://facebook.com/kisanwalaapp', 'https://facebook.com/learnatdice', 'https://facebook.com/marketplace/item/1662169807721886/', 'https://facebook.com/marketplace/item/1704849910463199/', 'https://facebook.com/marketplace/item/2058152751358941/', 'https://facebook.com/marketplace/item/3376290679332534/', 'https://facebook.com/marketplace/item/429727019764685/', 'https://facebook.com/marketplace/item/618766574314077/', 'https://facebook.com/marketplace/item/626139916948924/', 'https://facebook.com/marketplace/item/635161202625970/', 'https://facebook.com/marketplace/item/641782068339716/', 'https://facebook.com/marketplace/item/642233361872539/', 'https://facebook.com/marketplace/item/654760487311919/', 'https://facebook.com/marketplace/item/9289438541094989/', 'https://facebook.com/marketplace/item/957722063007039/', 'https://facebook.com/marketplace/item/960017502781499/', 'https://facebook.com/marketplace/item/976630887745511/', 'https://facebook.com/sfswebtech', 'https://facebook.com/zerobyted', 'https://www.facebook.com/100004124161037/', 'https://www.facebook.com/10000Speakers/', 'https://www.facebook.com/100042619962680/', 'https://www.facebook.com/100047216642974/', 'https://www.facebook.com/100049634293335/', 'https://www.facebook.com/100054686563302/', 'https://www.facebook.com/100057308145631/', 'https://www.facebook.com/100063488141199/', 'https://www.facebook.com/100063572784444/', 'https://www.facebook.com/100063656121845/', 'https://www.facebook.com/100063661465528/', 'https://www.facebook.com/100063701547199/', 'https://www.facebook.com/100063723265151/', 'https://www.facebook.com/100063744621462/', 'https://www.facebook.com/100063771451108/', 'https://www.facebook.com/100063774967563/', 'https://www.facebook.com/100063811729437/', 'https://www.facebook.com/100063904820890/', 'https://www.facebook.com/100063905569020/', 'https://www.facebook.com/100063905683300/', 'https://www.facebook.com/100063910386143/', 'https://www.facebook.com/100063910750698/', 'https://www.facebook.com/100063916542977/', 'https://www.facebook.com/100063942618535/', 'https://www.facebook.com/100063968083709/', 'https://www.facebook.com/100063988625777/', 'https://www.facebook.com/100064026634191/', 'https://www.facebook.com/100064044762372/', 'https://www.facebook.com/100064060512329/', 'https://www.facebook.com/100064106372627/', 'https://www.facebook.com/100064171202172/', 'https://www.facebook.com/100064180292717/', 'https://www.facebook.com/100064212273733/', 'https://www.facebook.com/100064244882749/', 'https://www.facebook.com/100064374450976/', 'https://www.facebook.com/100064792503784/', 'https://www.facebook.com/100064892594301/', 'https://www.facebook.com/100065365875431/', 'https://www.facebook.com/100065612344489/', 'https://www.facebook.com/100066409195176/', 'https://www.facebook.com/100066459475506/', 'https://www.facebook.com/100066520816526/', 'https://www.facebook.com/100066562785971/', 'https://www.facebook.com/100066617866298/', 'https://www.facebook.com/100066670989567/', 'https://www.facebook.com/100066926753859/', 'https://www.facebook.com/100066929901853/', 'https://www.facebook.com/100066966064670/', 'https://www.facebook.com/100067730595449/', 'https://www.facebook.com/100068101999559/', 'https://www.facebook.com/100068572843576/', 'https://www.facebook.com/100068647867921/', 'https://www.facebook.com/100069026882782/', 'https://www.facebook.com/100069027697685/', 'https://www.facebook.com/100069302533374/', 'https://www.facebook.com/100069614602375/', 'https://www.facebook.com/100069634334579/', 'https://www.facebook.com/100070061867183/', 'https://www.facebook.com/100070093785586/', 'https://www.facebook.com/100070584291429/', 'https://www.facebook.com/100070597098143/', 'https://www.facebook.com/100072061696478/', 'https://www.facebook.com/100072512042770/', 'https://www.facebook.com/100072547412154/', 'https://www.facebook.com/100075967193132/', 'https://www.facebook.com/100075984590483/', 'https://www.facebook.com/100076229040506/', 'https://www.facebook.com/100076233450363/', 'https://www.facebook.com/100076302100025/', 'https://www.facebook.com/100076342453309/', 'https://www.facebook.com/100076629837517/', 'https://www.facebook.com/100076836427779/', 'https://www.facebook.com/100076929697836/', 'https://www.facebook.com/100077578573633/', 'https://www.facebook.com/100078067532497/', 'https://www.facebook.com/100078114276308/', 'https://www.facebook.com/100078469461786/', 'https://www.facebook.com/100080842595900/', 'https://www.facebook.com/100081134994127/', 'https://www.facebook.com/100081745413106/', 'https://www.facebook.com/100081750801452/', 'https://www.facebook.com/100082056582170/', 'https://www.facebook.com/100082238243734/', 'https://www.facebook.com/100082506876930/', 'https://www.facebook.com/100082962595430/', 'https://www.facebook.com/100083041731484/', 'https://www.facebook.com/100083042091540/', 'https://www.facebook.com/100083064830310/', 'https://www.facebook.com/100083179697899/', 'https://www.facebook.com/100083189619066/', 'https://www.facebook.com/100083303592294/', 'https://www.facebook.com/100083327629517/', 'https://www.facebook.com/100083369859515/', 'https://www.facebook.com/100083400097627/', 'https://www.facebook.com/100083465297945/', 'https://www.facebook.com/100083551624864/', 'https://www.facebook.com/100083683983628/', 'https://www.facebook.com/100083734126288/', 'https://www.facebook.com/100083744893043/', 'https://www.facebook.com/100083972625774/', 'https://www.facebook.com/100084132261243/', 'https://www.facebook.com/100084135602581/', 'https://www.facebook.com/100084266545677/', 'https://www.facebook.com/100084383588561/', 'https://www.facebook.com/100085044948965/', 'https://www.facebook.com/100085300887617/', 'https://www.facebook.com/100085575553254/', 'https://www.facebook.com/100085889142551/', 'https://www.facebook.com/100086312264303/', 'https://www.facebook.com/100086312364273/', 'https://www.facebook.com/100086571162698/', 'https://www.facebook.com/100086574551796/', 'https://www.facebook.com/100086741334233/', 'https://www.facebook.com/100086789167926/', 'https://www.facebook.com/100087056850901/', 'https://www.facebook.com/100087174710069/', 'https://www.facebook.com/100087244784971/', 'https://www.facebook.com/100087398004581/', 'https://www.facebook.com/100087482599733/', 'https://www.facebook.com/100087679610044/', 'https://www.facebook.com/100087748321822/', 'https://www.facebook.com/100088229107710/', 'https://www.facebook.com/100088272204601/', 'https://www.facebook.com/100088315637745/', 'https://www.facebook.com/100088343112047/', 'https://www.facebook.com/100088669327599/', 'https://www.facebook.com/100088727982329/', 'https://www.facebook.com/100089193048145/', 'https://www.facebook.com/100089532180691/', 'https://www.facebook.com/100089571142059/', 'https://www.facebook.com/100089581003308/', 'https://www.facebook.com/100089662899838/', 'https://www.facebook.com/100089757842007/', 'https://www.facebook.com/100089774132519/', 'https://www.facebook.com/100089938917950/', 'https://www.facebook.com/100089941442874/', 'https://www.facebook.com/100090048758830/', 'https://www.facebook.com/100090127056054/', 'https://www.facebook.com/100090242095982/', 'https://www.facebook.com/100090344238023/', 'https://www.facebook.com/100090397544843/', 'https://www.facebook.com/100090560540590/', 'https://www.facebook.com/100090585017586/', 'https://www.facebook.com/100090629733956/', 'https://www.facebook.com/100090657682890/', 'https://www.facebook.com/100090687381595/', 'https://www.facebook.com/100091583167689/', 'https://www.facebook.com/100091630646511/', 'https://www.facebook.com/100091738520260/', 'https://www.facebook.com/100091805230867/', 'https://www.facebook.com/100091862045575/', 'https://www.facebook.com/100091905752241/', 'https://www.facebook.com/100091943787104/', 'https://www.facebook.com/100091949303406/', 'https://www.facebook.com/100092366247200/', 'https://www.facebook.com/100092388102213/', 'https://www.facebook.com/100092442398203/', 'https://www.facebook.com/100092455762572/', 'https://www.facebook.com/100092460071230/', 'https://www.facebook.com/100092510315074/', 'https://www.facebook.com/100092609786509/', 'https://www.facebook.com/100092654221413/', 'https://www.facebook.com/100092975224069/', 'https://www.facebook.com/100093022706453/', 'https://www.facebook.com/100093093234122/', 'https://www.facebook.com/100093199043605/', 'https://www.facebook.com/100093340546533/', 'https://www.facebook.com/100093363141779/', 'https://www.facebook.com/100093387743005/', 'https://www.facebook.com/100093663736410/', 'https://www.facebook.com/100093820552080/', 'https://www.facebook.com/100093970144993/', 'https://www.facebook.com/100094069894555/', 'https://www.facebook.com/100094071139772/', 'https://www.facebook.com/100094261250161/', 'https://www.facebook.com/100094262108785/', 'https://www.facebook.com/100094283359557/', 'https://www.facebook.com/100094323480699/', 'https://www.facebook.com/100094400654043/', 'https://www.facebook.com/100094422832272/', 'https://www.facebook.com/100094459567217/', 'https://www.facebook.com/100094653234114/', 'https://www.facebook.com/100094867173042/', 'https://www.facebook.com/100094894281559/', 'https://www.facebook.com/100094921104115/', 'https://www.facebook.com/100095092333693/', 'https://www.facebook.com/100095131793618/', 'https://www.facebook.com/100095157270489/', 'https://www.facebook.com/100095172506406/', 'https://www.facebook.com/100095231894164/', 'https://www.facebook.com/100095240596070/', 'https://www.facebook.com/100095272554205/', 'https://www.facebook.com/100095361393003/', 'https://www.facebook.com/100095393800063/', 'https://www.facebook.com/100095396322110/', 'https://www.facebook.com/100095633730328/', 'https://www.facebook.com/100095693971972/', 'https://www.facebook.com/13zero9/', 'https://www.facebook.com/175734858954531', 'https://www.facebook.com/1cnes.online/', 'https://www.facebook.com/24acres.official/', 'https://www.facebook.com/319648221234134', 'https://www.facebook.com/3karyaninfotech/', 'https://www.facebook.com/47logodesignstudio/', 'https://www.facebook.com/491249540740359', 'https://www.facebook.com/5-Star-Loan-651661324692020/', 'https://www.facebook.com/519000974628981', 'https://www.facebook.com/61550037360120/', 'https://www.facebook.com/61550066581236/', 'https://www.facebook.com/61550092476738/', 'https://www.facebook.com/61550114109587/', 'https://www.facebook.com/61550208173856/', 'https://www.facebook.com/61550354135326/', 'https://www.facebook.com/61550364095232/', 'https://www.facebook.com/61550480784000/', 'https://www.facebook.com/61550550487694/', 'https://www.facebook.com/61550568590838/', 'https://www.facebook.com/61550699682860/', 'https://www.facebook.com/61550717588053/', 'https://www.facebook.com/61550720686618/', 'https://www.facebook.com/61550787020475/', 'https://www.facebook.com/61550793879277/', 'https://www.facebook.com/61550809749740/', 'https://www.facebook.com/61550819062590/', 'https://www.facebook.com/61550886749799/', 'https://www.facebook.com/61550888818204/', 'https://www.facebook.com/61550892163925/', 'https://www.facebook.com/61550958304053/', 'https://www.facebook.com/61550977064635/', 'https://www.facebook.com/61551000016007/', 'https://www.facebook.com/61551046958457/', 'https://www.facebook.com/61551225470175/', 'https://www.facebook.com/61551259400389/', 'https://www.facebook.com/61551499312938/', 'https://www.facebook.com/61551809385886/', 'https://www.facebook.com/61551855934645/', 'https://www.facebook.com/61551945331046/', 'https://www.facebook.com/61552170982658/', 'https://www.facebook.com/61552300120254/', 'https://www.facebook.com/61552308464987/', 'https://www.facebook.com/61552366954627/', 'https://www.facebook.com/61552418325841/', 'https://www.facebook.com/61552497688786/', 'https://www.facebook.com/61552696401213/', 'https://www.facebook.com/61552713350358/', 'https://www.facebook.com/61552758509259/', 'https://www.facebook.com/61552776865199/', 'https://www.facebook.com/61552838567643/', 'https://www.facebook.com/61552862458376/', 'https://www.facebook.com/61552931228655/', 'https://www.facebook.com/61552944780520/', 'https://www.facebook.com/61553051859888/']


phone_list = set()
chunk_size = 100
semaphore = asyncio.Semaphore(8)

# Load existing numbers from CSV to prevent duplicates
if os.path.exists("phones.csv"):
    with open("phones.csv", newline="") as f:
        reader = csv.reader(f)
        phone_list.update(row[0] for row in reader)

async def process_url(browser, url):
    async with semaphore:
        page = await browser.new_page()
        try:
            await page.goto(url)
            try:
                await page.click("div[aria-label='Close']", timeout=3000)
            except:
                pass
            await page.wait_for_selector("div[role='main']")
            await page.wait_for_timeout(3000)
            phone_element = page.locator("text=/\\+?[0-9][0-9\\-\\s]{8,}/").first
            if await phone_element.count() > 0:
                raw = await phone_element.inner_text()
                cleaned = raw.replace(" ", "")
                if cleaned not in phone_list:
                    phone_list.add(cleaned)
                    with open("phones.csv", "a", newline="") as f:
                        writer = csv.writer(f)
                        writer.writerow([cleaned])
        except:
            pass
        finally:
            await page.close()
            LIST.remove(url)

async def go():
    async with async_playwright() as p:
        browser = await p.chromium.launch(headless=False)
        tasks = [process_url(browser, url) for url in LIST[:chunk_size]]
        await asyncio.gather(*tasks)
        await browser.close()

asyncio.run(go())
